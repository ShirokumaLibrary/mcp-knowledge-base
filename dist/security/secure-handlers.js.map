{"version":3,"file":"secure-handlers.js","sourceRoot":"","sources":["../../src/security/secure-handlers.ts"],"names":[],"mappings":"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"}