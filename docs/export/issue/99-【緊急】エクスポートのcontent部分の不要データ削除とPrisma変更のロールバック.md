---
id: 99
type: issue
title: "【緊急】エクスポートのcontent部分の不要データ削除とPrisma変更のロールバック"
description: "エクスポート機能でcontent部分に不要なデータが出力されているバグの修正と、現リリースバージョンに影響するPrisma関連の変更をロールバックする"
status: Completed
priority: CRITICAL
aiSummary: "【緊急】エクスポートのcontent部分の不要データ削除とPrisma変更のロールバック エクスポート機能でcontent部分に不要なデータが出力されているバグの修正と、現リリースバージョンに影響するPrisma関連の変更をロールバックする ## 問題の詳細\n\n### 1. エクスポート機能のバグ\n- エクスポートされたファイルのcontent部分に不要なデータが含まれている\n- これによりファイ"
tags: ["bug","critical","export","rollback","v0.8.3"]
keywords: {"prisma":1,"content":1,"migrate":1,"src":0.4,"cli":0.4}
related: [62,97]
created: 2025-08-20T00:40:08.563Z
updated: 2025-08-20T00:54:28.093Z
---

## 問題の詳細

### 1. エクスポート機能のバグ
- エクスポートされたファイルのcontent部分に不要なデータが含まれている
- これによりファイルサイズが不必要に大きくなっている
- ユーザーにとって読みにくい出力になっている

### 2. Prisma関連の変更問題
- 本日実施したPrisma関連の変更（migrateコマンドの修正）が現リリースバージョンに影響
- この変更は不要だったため、ロールバックが必要

## 対応内容

### 緊急度: CRITICAL
現在のリリースバージョンに影響するため、即座の対応が必要

### タスク

1. **Prisma変更のロールバック**
   - [ ] src/cli/index.ts のmigrateコマンド関連の変更を戻す
   - [ ] 特に`--schema`オプションの追加を削除
   - [ ] `__dirname`関連の変更を元に戻す

2. **エクスポート機能の修正**
   - [ ] エクスポート時のcontent部分を精査
   - [ ] 不要なデータ（重複、メタデータ等）を除外
   - [ ] 必要最小限の情報のみ出力するよう修正

3. **テスト**
   - [ ] エクスポート機能のテスト
   - [ ] migrateコマンドの動作確認
   - [ ] 既存機能への影響確認

## 影響範囲

- エクスポート機能を使用しているユーザー
- グローバルインストールでmigrateコマンドを使用するユーザー

## 修正方針

1. まずgitで本日の変更を確認
2. Prisma関連の変更をrevert
3. エクスポート機能のバグを別途修正
4. v0.8.2のパッチリリース（v0.8.3）として準備

## 注意事項

- initコマンド（SQLite直接実行）は新機能なので残す
- migrateコマンドは元の実装に戻す
- エクスポート機能は最小限の修正に留める