---
id: 137
type: steering
title: "コア設定"
status: Unknown
priority: HIGH
description: "SHIROKUMA Knowledge Baseコアプロジェクト設定"
aiSummary: "SHIROKUMA Knowledge Base is a TypeScript-based knowledge management system implemented as an MCP server, featuring Prisma/SQLite architecture, Claude AI integration for automatic content enrichment, hybrid search capabilities with embedding vectors, and comprehensive CRUD operations for knowledge management."
tags: ["architecture","inclusion:always","core","pattern:shirokuma"]
keywords: {"shirokuma":1,"mcp":0.9,"knowledge":0.9,"ai":0.8,"search":0.8}
concepts: {"knowledge management":0.9,"database":0.8,"architecture":0.8,"ai integration":0.8,"search":0.8}
embedding: "hYSAgICAgICQhICKgIKXpICAgICAgICAi4CFlICLl5WDhoCAgICAgIOCgJWAlY6MjJCAgICAgICAgIWNgI+CgIaWgICAgICAhIWSg4CWgIiPk4CAgICAgIyNmYCAk4mdk5aAgICAgICGkJSHgIiVmY6OgICAgICAjoyIgYCAjac="
createdAt: 2025-08-23T02:03:53.000Z
updatedAt: 2025-08-23T12:11:02.000Z
---

# SHIROKUMA Knowledge Base - コア設定

**バージョン**: 0.9.0
**最終更新**: 2025-08-23

## プロジェクト概要

SHIROKUMA Knowledge Baseは、MCP (Model Context Protocol) サーバーとして実装された知識管理システムです。

### 主な特徴
- **アーキテクチャ**: TypeORM + SQLite
- **言語**: TypeScript (ES2022, ESM)
- **AI統合**: Claude AI による自動エンリッチメント
- **検索**: キーワード、コンセプト、埋め込みベクトルによるハイブリッド検索

## 技術スタック

```yaml
project:
  name: "@shirokuma-library/mcp-knowledge-base"
  version: "0.9.0"
  type: "mcp_server"
  
runtime:
  language: "TypeScript"
  node: ">=18.0.0"
  module: "ESModule"
  
database:
  orm: "TypeORM"
  engine: "SQLite"
  location: ".shirokuma/data/shirokuma.db"
  
dependencies:
  core:
    - "@modelcontextprotocol/sdk": "^1.17.2"
    - "typeorm": "^0.3.20"
    - "commander": "^14.0.0"
    - "chalk": "^5.5.0"
    - "zod": "^3.25.76"
```

## ディレクトリ構造

```
shirokuma-v8/
├── src/
│   ├── cli/               # CLIコマンド実装
│   ├── mcp/              # MCPサーバー実装
│   │   ├── server.ts     # メインサーバー
│   │   └── tools/        # ツール定義
│   ├── services/         # ビジネスロジック
│   │   └── ai/          # AI関連サービス（モジュール化済み）
│   ├── entities/         # TypeORMエンティティ
│   ├── repositories/     # データアクセス層
│   └── utils/            # ユーティリティ
│       └── validation.ts # バリデーション（typeフィールド等）
├── dist/                 # ビルド出力
├── .shirokuma/
│   ├── commands/        # カスタムコマンド定義
│   │   ├── kuma/        # kumaコマンド群
│   │   └── shared/      # 共有リソース
│   ├── data-prod/       # 本番データベース（開発環境のみ）
│   └── data-dev/        # 開発データベース（開発環境のみ）
└── .claude/
    ├── agents/          # AIエージェント定義
    ├── commands/        # コマンドシンボリックリンク
    └── output-styles/   # 出力スタイル定義
```

## データモデル

### Item（メインエンティティ）
```typescript
{
  id: number
  type: string          // a-z, 0-9, _ のみ
  title: string
  description: string
  content: string
  aiSummary?: string    // AI生成サマリー
  statusId: number
  priority: Priority
  category?: string
  startDate?: Date
  endDate?: Date
  version?: string
  searchIndex?: string  // 検索用インデックス
  embedding?: Buffer    // 量子化済み埋め込みベクトル
  createdAt: Date
  updatedAt: Date
}
```

### 関連テーブル
- **Status**: ステータス管理
- **Tag / ItemTag**: タグ管理
- **Keyword / ItemKeyword**: キーワード管理（正規化済み）
- **Concept / ItemConcept**: コンセプト管理（正規化済み）
- **ItemRelation**: アイテム間の関係
- **SystemState**: システム状態（カレントステート）

## AI機能

### エンリッチメント
アイテム作成時に自動的に以下を生成：
- **キーワード抽出**: TF-IDFによる重み付き英語キーワード
- **コンセプト検出**: 高レベルカテゴリの識別
- **サマリー生成**: 簡潔な要約
- **埋め込みベクトル**: 128次元、Int8量子化

### 検索戦略
```typescript
// キーワード検索
strategy: 'keywords'

// コンセプト検索  
strategy: 'concepts'

// 埋め込みベクトル検索
strategy: 'embedding'

// ハイブリッド検索
strategy: 'hybrid',
weights: { keywords: 0.4, embedding: 0.6 }
```

## CLI コマンド

```bash
# アイテム操作
shirokuma-kb create -t <type> -T <title> -d <description>
shirokuma-kb list [--type <type>] [--status <status>]
shirokuma-kb get <id>
shirokuma-kb update <id> [options]
shirokuma-kb delete <id>

# 検索
shirokuma-kb search <query>
shirokuma-kb related <id>

# システム
shirokuma-kb migrate [--reset] [--seed]
shirokuma-kb serve
```

## MCP ツール

### 基本CRUD
- `create_item` - アイテム作成（AI自動エンリッチメント付き）
- `get_item` - アイテム取得
- `update_item` - アイテム更新
- `delete_item` - アイテム削除

### 検索・一覧
- `search_items` - 高度な検索（AND/OR、日付範囲、フィルター）
- `list_items` - フィルタリング・ソート付き一覧

### 関係管理
- `get_related_items` - 関連アイテム取得（複数戦略）
- `add_relations` - 双方向リレーション追加

### システム
- `get_current_state` - 現在のシステム状態取得
- `update_current_state` - システム状態更新
- `get_stats` - 統計情報取得

## 開発原則

1. **イシュー駆動開発** - コード変更前に必ずイシュー作成
2. **TDD** - テスト → 実装 → リファクタリング
3. **即座の記録** - アイデアは思いついたらすぐMCPに記録
4. **型安全性** - TypeScript + Zod による厳格な型検証
5. **モジュール化** - 機能ごとに分離されたモジュール構成