---
id: 135
type: steering
title: "テスト設定"
status: Unknown
priority: HIGH
description: "TypeScriptプロジェクトのテスト標準と設定"
aiSummary: "Comprehensive testing configuration guide for TypeScript projects covering pre-flight checks, manual testing procedures, test organization, common scenarios, debugging techniques, and quality gates to ensure code reliability and maintainability."
tags: ["quality","testing","inclusion:always","pattern:typescript"]
keywords: {"test":1,"typescript":0.9,"configuration":0.9,"validation":0.8,"build":0.8}
concepts: {"testing":0.95,"quality assurance":0.9,"development":0.85,"automation":0.8,"configuration":0.8}
embedding: "hICWkYCAipOAgICigICKjoCAmIuAgIGRgICAooCAkouCgJODgICBiICAgJyAgJKDiYCIgICAioGAgICWgICLgISAgISAgJOBgICAlYCAgoKLgIOMgICViYCAgJuAgICAjoCOkYCAjZKAgICogICAhIuAl42AgJSTgICAnYCAgYs="
createdAt: 2025-08-23T02:02:30.000Z
updatedAt: 2025-08-23T02:08:25.000Z
---

# テスト設定

## 事前チェック

作業開始前に、開発環境の準備ができていることを確認するチェック項目：

### 1. ビルド検証
プロジェクトがエラーなくビルドされることを確認：
```bash
npm run build
```

### 2. Lint検証  
コード品質の問題をチェック：
```bash
npm run lint:errors  # エラーのみ表示
npm run lint        # すべての問題を表示
```

### 3. 型チェック
TypeScriptの型が正しいことを確認：
```bash
npm run type-check  # または npx tsc --noEmit
```

### 4. テストスイート
自動テストを実行（設定されている場合）：
```bash
npm test
```
*注: 必要に応じてpackage.jsonでテストスクリプトを設定*

### 5. データベース検証
データベースを使用するプロジェクトの場合：
```bash
# データベースの存在確認
ls -la .shirokuma/data/

# 必要に応じてマイグレーション実行
shirokuma-kb migrate
```

### 6. 環境検証
必要なツールと依存関係を確認：
```bash
# Node.jsバージョン
node -v

# パッケージ依存関係
npm ls --depth=0

# Prismaクライアント（Prisma使用時）
npx prisma generate
```

## 手動テスト

### CLIテスト
```bash
# テストアイテム作成
shirokuma-kb create -t test_type -T "Test Title" -d "Test Description"

# アイテム一覧
shirokuma-kb list

# 特定アイテム取得
shirokuma-kb get 1

# アイテム検索
shirokuma-kb search "keyword"
```

### MCPサーバーテスト
```bash
# MCPサーバー起動
npm run serve

# MCPクライアント（例：Claude Desktop）でテスト
# ツール使用: create_item, get_item, update_item, search_items
```

## テスト構成

### テストファイル構造
```
tests/
├── unit/           # 個別関数の単体テスト
├── integration/    # サービスの統合テスト
├── e2e/           # エンドツーエンドテスト
└── fixtures/      # テストデータとモック
```

### テスト命名規則
- テストファイル: `*.test.ts` または `*.spec.ts`
- テスト説明: 明確で振る舞いに焦点を当てた記述
- 例: `should create item with valid data`

## 一般的なテストシナリオ

### 1. CRUD操作
- 有効/無効なデータでの作成
- 存在する/しないアイテムの読み取り
- 部分的/完全なデータでの更新
- カスケード効果を伴う削除

### 2. 検索とフィルター
- キーワード検索の精度
- フィルターの組み合わせ
- ページネーションの動作
- 空の結果の処理

### 3. エラー処理
- 無効な入力の検証
- データベース接続エラー
- タイムアウト処理
- グレースフルデグレード

### 4. パフォーマンス
- 負荷時の応答時間
- メモリ使用パターン
- データベースクエリの最適化
- 同時リクエストの処理

## テストのデバッグ

### 詳細出力
```bash
# デバッグ情報付きで実行
DEBUG=* npm test

# 特定のテストファイルを実行
npm test -- path/to/test.spec.ts

# ウォッチモードでテスト実行
npm test -- --watch
```

### 一般的な問題
1. **データベースが見つからない**: `shirokuma-kb migrate`を実行
2. **Prismaクライアントが古い**: `npx prisma generate`を実行
3. **型エラー**: 詳細は`npm run type-check`で確認
4. **Lintエラー**: 詳細は`npm run lint:errors`で確認

## 品質ゲート

コードをコミットする前に、以下を確認：
- [ ] すべてのテストが合格
- [ ] TypeScriptエラーなし
- [ ] ESLintエラーなし
- [ ] ビルド成功
- [ ] ドキュメント更新済み