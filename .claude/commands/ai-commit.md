---
allowed-tools: Bash(git add:*), Bash(git status:*), Bash(git commit:*), Bash(git diff:*), Bash(npm run build:*), Bash(npm test:*), Bash(npm version:*), Bash(npm publish:*), Bash(npm whoami:*), Bash(npm pack:*)
description: Commit changes following project guidelines and handle releases
---

## Context

- Current git status: !`git status`
- Current git diff (staged and unstaged changes): !`git diff HEAD`
- Current branch: !`git branch --show-current`
- Recent commits: !`git log --oneline -5`

## Task

Execute conventional commits in this specific order:

### 1. Source Code
```bash
git add src/ --exclude='*.test.ts' --exclude='*.spec.ts' --exclude='__tests__'
git add package.json tsconfig.json
```

### 2. Test Code
```bash
git add src/**/*.test.ts src/**/*.spec.ts src/__tests__/
```

### 3. Distribution Files  
```bash
npm run build  # MUST use production build, not dev
git add dist/
```

### 4. Documentation
```bash
git add docs/ *.md
```

## Critical Rules

1. **Never include AI references in commits** (no "generated by", "created with AI", etc.)
2. **Always use production build** for dist/ (excludes tests, maps, .d.ts)
3. **Semantic versioning**: patch=fixes, minor=features, major=breaking

## Version Release

When requested (e.g., "0.0.1バージョン上げて"):

1. Update CHANGELOG.md (move [Unreleased] to new version)
2. `git commit -m "docs: update CHANGELOG for vX.X.X"`
3. `npm version patch/minor/major -m "chore: release v%s"`
4. `git push && git push --tags`
5. `npm publish`

## CHANGELOG Format

```markdown
## [Unreleased]
### Added/Changed/Fixed

## [0.0.9] - 2024-01-15
### Added
- User-facing feature description
```

Focus on user impact, not implementation details.